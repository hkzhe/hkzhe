var facebookLogin=function(){FB.getLoginStatus(function(n){n.status==="connected"?(console.log(n),FB.login(function(n){submitFacebookAuth(n)},{scope:"email,publish_actions"})):n.status==="not_authorized"?(console.log("not authorized!"),FB.login(function(n){n.authResponse?submitFacebookAuth(n):($(".facebookButton span.login").text("Try again..."),$(".facebookButton .loader").hide())},{scope:"email,publish_actions"})):(console.log("User is not logged into Facebook - Then Login !"),FB.login(function(n){n.authResponse?submitFacebookAuth(n):($(".facebookButton span.login").text("Try again..."),$(".facebookButton .loader").hide())},{scope:"email,publish_actions"}))})},notificationsEnum={2:"Has requested to join",12:"Has requested to join",4:"approved your request for",13:"approved your request for",6:"Joined your activity",14:"Joined your activity",8:"Commented on",9:"Likes your recommendation",10:"Invited you to",11:"Invited you to",15:"Is now following you"},HandleAjaxError=function(){},Modal=function(n){this.element=n,this.closeElement=n.find(".closeButton"),this.container=n.parent(),this.loginElement=n.find(".facebookButton"),this.popup=function(){$(".modal").dialog({modal:!0,zindex:1e3,dialogClass:"custom",width:672,height:502,resizable:!1,draggable:!1})},this.close=function(){$(".modal").dialog("close"),$("html").unbind("keyup")},this.destroy=function(){n.parent().destroy()},n.click(function(n){n.stopPropagation()}),this.closeElement.click(function(){$(".modal").dialog("close"),$("html").unbind("keyup")})},CreateNewModal=function(){var n=$("#signinModal"),t;n.length>0&&(t=new Modal(n),$(document).bind("modal-popup",function(){t.popup()}))},fixPlaceholder;$(document).ready(function(){if($("#header-lower").length>0){var n=$("#body");n.css("margin-top","40px")}$(".header-user-area").mouseenter(function(){$(".menuItem").removeClass("active")}),$(".header-user-area .user").click(function(){var n=$(this).attr("data-link");window.location=n}),$(".menuItem .icon").click(function(n){var t=$(this).parent();t.siblings().removeClass("active"),t.toggleClass("active"),n.stopPropagation()});$(".menuItem .icon").one("click",function(){var t=$(this).parent(),i=t.find(".contentWrap"),r=t.attr("data-method");i.html('<img src="'+i.attr("data-loader")+'" alt="Purple Loader" class="loader"/>'),t.siblings().removeClass("active"),t.addClass("active"),$.getJSON(r).done(function(n){var c=t.attr("data-template"),l=$("#"+c).html(),u,f,r,o,s,h,e;if(n.Notifications){u=n.Notifications;for(f in u)r=u[f],r.Verb=notificationsEnum[r.Type],o=r.Type===15?"":'"'+r.Summary+'"',r.Summary=o,s=r.Type===15?"/users/"+r.RequestingUserSlug:"/activities/details/"+r.ObjectId,r.DataLink=s,u[f]=r;console.log(u)}h=n.Notifications?n.Notifications.length:n.Threads.length,e=n.Notifications?"<p class='message-text'> <span class='message'> <b> You have no notifications </b> </span> </p>":"<p class='message-text'> <span class='message'> <b> You have no messages, yet... </span> </b> </p>",h&&(e=Mustache.to_html(l,n)),i.html(e),$("abbr.timeago").timeago(),t.children(".icon").children(".badge").hide()}).fail(HandleAjaxError())});$(".menuItem .header-notif-container").click(function(n){n.stopPropagation()}),$("html").click(function(){$(".menuItem").removeClass("active"),$(".modal").dialog("close")}),$(".facebookButton").click(function(){$(this).find(".loader").show(),$(this).find("span").text("Calling Mark..."),facebookLogin()}),$("[placeholder]").each(function(n,t){fixPlaceholder(t)}),CreateNewModal(),$("#header-log-in").click(function(n){$(document).trigger("modal-popup"),n.stopPropagation()})}),fixPlaceholder=function(n){var t=$(n);t.focus(function(){var n=$(this);n.val()===n.attr("placeholder")&&(n.val(""),n.removeClass("placeholder"))}).blur(function(){var n=$(this);(n.val()===""||n.val()===n.attr("placeholder"))&&(n.addClass("placeholder"),n.val(n.attr("placeholder")))}).blur().parents("form").submit(function(){$(this).find("[placeholder]").each(function(){var n=$(this);n.val()===n.attr("placeholder")&&n.val("")})})}